{% load static %}
로그인 페이지<br>

{% if user.is_authenticated %}

로그인 성공! {{ user.nick_name }}님 환영합니다.<br>
{% if user.profile_img %}
    <img src="{{ user.profile_img.url }}" width="100" height="100" alt="프로필사진"><br>
{% endif %}
<a href="{% url 'users:logout' %}">로그아웃</a>
<br><br>

<!-- DropBox Button -->
<label for="workouts">운동 종목 선택: </label>
<select id="workouts">
    <option value="squat">스쿼트</option>
    <option value="dumbellcurl">덤벨컬</option>
</select>
<br>

<!-- 동영상 -->
<video src="{% static 'squat.mp4' %}" width="600" height="400" controls id="squatVideo"></video><br>
<video src="{% static 'dumbell_curl.mp4' %}" width="600" height="400" controls id="dumbellCurlVideo" style="display: none;"></video><br>

<!-- Prev Start Next Button -->
<button type="button" id="prev">Prev</button>
<button type="button" id="start">Start</button>
<button type="button" id="next">Next</button>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        let squatVideo = document.querySelector("#squatVideo");
        let dumbellCurlVideo = document.querySelector("#dumbellCurlVideo");
        let prevBtn = document.querySelector("#prev");
        let nextBtn = document.querySelector("#next");
        let startBtn = document.querySelector("#start");
        let selectBox = document.querySelector("#workouts");

        function changeVideo(prev) {
            selectBox.selectedIndex = prev ? selectBox.selectedIndex - 1 : selectBox.selectedIndex + 1;

            if (selectBox.selectedIndex === -1) {
                selectBox.selectedIndex = prev ? selectBox.options.length - 1 : 0;
            }

            selectBox.dispatchEvent(new Event('change'));
        }

        prevBtn.addEventListener("click", function (e) {
            changeVideo(true);
        });

        nextBtn.addEventListener("click", function (e) {
            changeVideo(false);
        });

        startBtn.addEventListener("click", function (e) {
            alert("시작");
        });
        
        selectBox.addEventListener('change', function (e) {
            switch (e.target.value) {
                case "squat":
                    squatVideo.style.display = "";
                    dumbellCurlVideo.style.display = "none";
                    break;
                case "dumbellcurl":
                    squatVideo.style.display = "none";
                    dumbellCurlVideo.style.display = "";
                    break;
            }
        });
    })
</script>

<!-- 그래프 처리 -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
<div style="height: 300px; width: 400px;">
    <canvas id="myChart" width="100" height="100"></canvas>
</div>
<script>
    var ctx = document.getElementById('myChart').getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['30', '31', '1', '2', '3', '4', '5'],
            datasets: [{
                label: '운동 횟수',
                data: [12, 19, 3, 5, 2, 3, 8],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)',
                    'rgba(0, 0, 0, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)',
                    'rgba(0, 0, 0, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });
</script>

{% else %}

<img src="{% static '2.jpg' %}" alt=""><br>
<form action="" method="POST">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" value="로그인">
</form>
<a href="{% url 'users:signup' %}">회원가입</a>

{% endif %}
